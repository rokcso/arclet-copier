# âœ… esbuild é…ç½®å®ŒæˆæŠ¥å‘Š

## ğŸ‰ é…ç½®å®Œæˆï¼

esbuild æ„å»ºç³»ç»Ÿå·²æˆåŠŸé›†æˆåˆ° Arclet Copier é¡¹ç›®ä¸­ã€‚

---

## ğŸ“Š æ€§èƒ½æå‡æ€»ç»“

| æŒ‡æ ‡ | ä¹‹å‰ | ç°åœ¨ | æå‡ |
|------|------|------|------|
| **æ„å»ºé€Ÿåº¦** | ~1000ms | ~15ms | **66x faster** âš¡ |
| **JS ä»£ç ä½“ç§¯** | 455KB | 134KB | **-70%** ğŸ“¦ |
| **æ€»åŒ…å¤§å°** | æœªçŸ¥ | 645KB | å·²ä¼˜åŒ– |
| **å¼€å‘ä½“éªŒ** | æ‰‹åŠ¨æ„å»º | Watch è‡ªåŠ¨æ„å»º | **æå¤§æå‡** ğŸš€ |
| **ä»£ç è´¨é‡** | æœªå‹ç¼© | å·²å‹ç¼© + Tree Shaking | **æ˜¾è‘—æé«˜** âœ¨ |

---

## ğŸ¯ æ–°å¢åŠŸèƒ½

### 1. ç”Ÿäº§æ„å»ºï¼ˆå·²ä¼˜åŒ–ï¼‰
```bash
npm run build
```
- âœ… ä»£ç å‹ç¼©å’Œæ··æ·†
- âœ… Tree Shakingï¼ˆç§»é™¤æœªä½¿ç”¨ä»£ç ï¼‰
- âœ… æ„å»ºåˆ†ææŠ¥å‘Š
- âœ… è¾“å‡ºè¯¦ç»†ç»Ÿè®¡
- ğŸ“ è¾“å‡ºåˆ° `dist/arclet-copier-v{version}/`

### 2. å¼€å‘æ¨¡å¼ï¼ˆå…¨æ–°ï¼‰
```bash
npm run dev
```
- âœ… Watch æ¨¡å¼ï¼ˆæ–‡ä»¶å˜åŒ–è‡ªåŠ¨æ„å»ºï¼‰
- âœ… Source Map æ”¯æŒï¼ˆä¾¿äºè°ƒè¯•ï¼‰
- âœ… å¿«é€Ÿæ„å»ºï¼ˆæ— å‹ç¼©ï¼‰
- âœ… å®æ—¶åé¦ˆ
- ğŸ“ è¾“å‡ºåˆ° `dist-dev/`

---

## ğŸ“ æ–°å¢æ–‡ä»¶

### é…ç½®æ–‡ä»¶
- `scripts/esbuild.config.js` - esbuild æ„å»ºé…ç½®ï¼ˆä¸»è¦é…ç½®ï¼‰

### æ–‡æ¡£
- `BUILD_GUIDE.md` - è¯¦ç»†çš„æ„å»ºæŒ‡å—
- `BUILD_TOOLS_COMPARISON.md` - æ„å»ºå·¥å…·å¯¹æ¯”åˆ†æ

### ä¾èµ–
- `package.json` - æ›´æ–°äº† scripts å’Œ dependencies
  - æ–°å¢: `esbuild@^0.25.10`
  - ç§»é™¤: `esbuild-plugin-copy`ï¼ˆä½¿ç”¨åŸç”Ÿ fs æ›¿ä»£ï¼‰

### .gitignore æ›´æ–°
- æ·»åŠ  `dist-dev/` - å¼€å‘æ„å»ºè¾“å‡º
- æ·»åŠ  `meta.json` - æ„å»ºåˆ†ææ–‡ä»¶

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### é¦–æ¬¡ä½¿ç”¨
```bash
# 1. å®‰è£…ä¾èµ–ï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰
npm install

# 2. ç”Ÿäº§æ„å»º
npm run build

# 3. åŠ è½½åˆ° Chrome
# - è®¿é—® chrome://extensions/
# - å¼€å¯"å¼€å‘è€…æ¨¡å¼"
# - ç‚¹å‡»"åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº"
# - é€‰æ‹©: dist/arclet-copier-v1.6.3/
```

### æ—¥å¸¸å¼€å‘
```bash
# 1. å¯åŠ¨å¼€å‘æ¨¡å¼
npm run dev

# 2. åœ¨ Chrome ä¸­åŠ è½½ dist-dev/ ç›®å½•

# 3. ä¿®æ”¹ä»£ç ï¼Œè‡ªåŠ¨é‡æ–°æ„å»º

# 4. æ‰‹åŠ¨åˆ·æ–° Chrome æ‰©å±•
```

---

## ğŸ“Š æ„å»ºäº§ç‰©å¯¹æ¯”

### ä¹‹å‰ï¼ˆæ–‡ä»¶å¤åˆ¶ï¼‰
```
æ„å»ºè¾“å‡º:
scripts/dist/arclet-copier-v1.6.3/
â”œâ”€â”€ background/background.js    (æœªå‹ç¼©)
â”œâ”€â”€ popup/popup.js             (æœªå‹ç¼©)
â”œâ”€â”€ options/options.js         (æœªå‹ç¼©)
â””â”€â”€ ...

æ€»å¤§å°: ~455KB (ä»… JS)
æ„å»ºæ—¶é—´: ~1s
```

### ç°åœ¨ï¼ˆesbuildï¼‰
```
ç”Ÿäº§æ„å»ºè¾“å‡º:
dist/arclet-copier-v1.6.3/
â”œâ”€â”€ background/background.js    29.13 KB (å·²å‹ç¼©)
â”œâ”€â”€ popup/popup.js              30.78 KB (å·²å‹ç¼©)
â”œâ”€â”€ options/options.js          29.24 KB (å·²å‹ç¼©)
â”œâ”€â”€ batch/batch.js              32.71 KB (å·²å‹ç¼©)
â”œâ”€â”€ content/content.js          11.08 KB (å·²å‹ç¼©)
â”œâ”€â”€ offscreen/offscreen.js       0.95 KB (å·²å‹ç¼©)
â”œâ”€â”€ assets/                     (èµ„æºæ–‡ä»¶)
â”œâ”€â”€ _locales/                   (å¤šè¯­è¨€)
â”œâ”€â”€ manifest.json               (æ¸…å•æ–‡ä»¶)
â””â”€â”€ meta.json                    9.00 KB (æ„å»ºåˆ†æ)

Total JS: 133.89 KB (-70%)
Total Package: 644.54 KB
æ„å»ºæ—¶é—´: ~15ms (66x faster)
```

---

## ğŸ” æµ‹è¯•ç»“æœ

### âœ… ç”Ÿäº§æ„å»ºæµ‹è¯•
```bash
$ npm run build

ğŸš€ Building Arclet Copier v1.6.3...
ğŸ“¦ Mode: Production
ğŸ“ Output: /Users/lin/Developer/arclet-copier/scripts/dist/arclet-copier-v1.6.3

âš¡ Done in 15ms
âœ… Build completed successfully!

ğŸ“Š Build Analysis:
   Total JS: 133.89 KB (0.13 MB)
   Total Package: 644.54 KB (0.63 MB)
```

### âœ… å¼€å‘æ¨¡å¼æµ‹è¯•
```bash
$ npm run dev

ğŸš€ Building Arclet Copier v1.6.3...
ğŸ“¦ Mode: Development
ğŸ“ Output: /Users/lin/Developer/arclet-copier/dist-dev

âœ… Initial build complete!
ğŸ”„ Watching for changes...
[watch] build finished, watching for changes...
```

---

## ğŸ“š æ–‡æ¡£è¯´æ˜

### BUILD_GUIDE.md
å®Œæ•´çš„æ„å»ºæŒ‡å—ï¼ŒåŒ…æ‹¬ï¼š
- ğŸš€ å¿«é€Ÿå¼€å§‹
- ğŸ”§ å¼€å‘å·¥ä½œæµ
- ğŸ“¦ å‘å¸ƒæµç¨‹
- ğŸ¯ ä¼˜åŒ–å»ºè®®
- ğŸ› å¸¸è§é—®é¢˜
- ğŸ“š ç›¸å…³èµ„æº

### BUILD_TOOLS_COMPARISON.md
æ„å»ºå·¥å…·å¯¹æ¯”åˆ†æï¼ŒåŒ…æ‹¬ï¼š
- esbuild vs Vite vs Rollup vs Webpack
- è¯¦ç»†çš„æ€§èƒ½å¯¹æ¯”
- é€‚ç”¨åœºæ™¯åˆ†æ
- æ¨èæ–¹æ¡ˆå’Œå®æ–½è®¡åˆ’

---

## ğŸ¨ æœªæ¥ä¼˜åŒ–æ–¹å‘

è™½ç„¶å½“å‰æ„å»ºå·²ç»å¾ˆä¼˜ç§€ï¼Œä½†ä»æœ‰ä¼˜åŒ–ç©ºé—´ï¼š

### 1. CSS ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰
```bash
# å½“å‰ CSS æœªå‹ç¼©ï¼Œå¯èŠ‚çœ 30-40% ä½“ç§¯
npm install -D lightningcss
```

### 2. å›¾ç‰‡ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰
```bash
# å‹ç¼© assets/ ä¸­çš„å›¾æ ‡
npm install -D imagemin imagemin-pngquant
```

### 3. ä»£ç åˆ†å‰²ï¼ˆæœªæ¥ï¼‰
å¦‚æœä»£ç é‡ç»§ç»­å¢é•¿ï¼Œå¯ä»¥å¯ç”¨ä»£ç åˆ†å‰²ï¼š
```javascript
splitting: true  // åœ¨ esbuild.config.js ä¸­å¯ç”¨
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. å¼€å‘æ¨¡å¼ä¸ä¼šè‡ªåŠ¨åˆ·æ–°æ‰©å±•
Chrome æ‰©å±•ä¸æ”¯æŒçƒ­æ›´æ–°ï¼ˆHMRï¼‰ï¼Œä¿®æ”¹ä»£ç åéœ€è¦ï¼š
1. ç­‰å¾…è‡ªåŠ¨æ„å»ºå®Œæˆ
2. æ‰‹åŠ¨åœ¨ `chrome://extensions/` é¡µé¢åˆ·æ–°æ‰©å±•

### 2. æ„å»ºè¾“å‡ºç›®å½•
- **ç”Ÿäº§æ„å»º**: `dist/arclet-copier-v{version}/`
- **å¼€å‘æ„å»º**: `dist-dev/`ï¼ˆå« Source Mapï¼‰

---

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

### ç«‹å³å¯ä»¥åšçš„
1. âœ… å°è¯• `npm run dev` ä½“éªŒå¼€å‘æ¨¡å¼
2. âœ… è¿è¡Œ `npm run build` æŸ¥çœ‹ä¼˜åŒ–æ•ˆæœ
3. âœ… é˜…è¯» `BUILD_GUIDE.md` äº†è§£è¯¦ç»†ç”¨æ³•

### æœªæ¥å¯ä»¥è€ƒè™‘çš„
1. ğŸ’¡ æ·»åŠ  CSS å‹ç¼©ï¼ˆlightningcssï¼‰
2. ğŸ’¡ æ·»åŠ  ESLint æ£€æŸ¥
3. ğŸ’¡ æ·»åŠ å•å…ƒæµ‹è¯•ï¼ˆVitestï¼‰
4. ğŸ’¡ æ·»åŠ  TypeScript æ”¯æŒï¼ˆå¯é€‰ï¼‰

---

## ğŸ“ æ›´æ–°è®°å½•

### 2024-10-10
- âœ… å®‰è£… esbuild ä¾èµ–
- âœ… åˆ›å»º esbuild.config.js é…ç½®
- âœ… æ›´æ–° package.json scripts
- âœ… æ›´æ–° .gitignore è§„åˆ™
- âœ… æµ‹è¯•ç”Ÿäº§æ„å»ºï¼ˆæˆåŠŸï¼‰
- âœ… æµ‹è¯•å¼€å‘æ¨¡å¼ï¼ˆæˆåŠŸï¼‰
- âœ… åˆ›å»ºè¯¦ç»†æ–‡æ¡£

---

## ğŸ’¬ åé¦ˆ

å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
- ğŸ“§ æäº¤ Issue: https://github.com/rokcso/arclet-copier/issues
- ğŸ’¬ æˆ–é€šè¿‡é‚®ä»¶è”ç³»: hi@rokcso.com

---

**ğŸ‰ æ­å–œï¼esbuild æ„å»ºç³»ç»Ÿå·²æˆåŠŸé›†æˆï¼**

äº«å—æé€Ÿçš„å¼€å‘ä½“éªŒå§ï¼âš¡
